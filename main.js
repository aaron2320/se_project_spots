!function(){"use strict";var e={117:function(e,t,r){e.exports=r.p+"2fc47fd8e9a9bcd9612f.jpg"}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var a=t[n]={exports:{}};return e[n](a,a.exports,r),a.exports}r.p="";const n={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__submit-btn",inactiveButtonClass:"modal__submit-btn_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error"},o=(e,t,r)=>{e.querySelector(`#${t.id}-error`).textContent="",t.classList.remove(r.inputErrorClass)},a=(e,t,r)=>{(e=>e.some((e=>!e.validity.valid)))(e)?(t.disabled=!0,t.classList.add(r.inactiveButtonClass)):(t.disabled=!1,t.classList.remove(r.inactiveButtonClass))},s=(e,t)=>{Array.from(e.querySelectorAll(t.inputSelector)).forEach((r=>o(e,r,t)))},c=new class{constructor(e){let{baseUrl:t,headers:r}=e;this.baseUrl=t,this.headers=r}_checkResponse(e){return e.ok?e.json():e.text().then((t=>{throw new Error(`HTTP error! Status: ${e.status} - ${t}`)}))}getAppInfo(){return Promise.all([this.getUserInfo(),this.getInitialCards()]).then((e=>{let[t,r]=e;return{user:t,cards:r}}))}getUserInfo(){return fetch(`${this.baseUrl}/users/me`,{headers:this.headers}).then(this._checkResponse)}getInitialCards(){return fetch(`${this.baseUrl}/cards`,{headers:this.headers}).then(this._checkResponse)}editUserInfo(e){let{name:t,about:r}=e;return fetch(`${this.baseUrl}/users/me`,{method:"PATCH",headers:this.headers,body:JSON.stringify({name:t,about:r})}).then(this._checkResponse)}addCard(e){let{name:t,link:r}=e;return fetch(`${this.baseUrl}/cards`,{method:"POST",headers:this.headers,body:JSON.stringify({name:t,link:r})}).then(this._checkResponse)}removeCard(e){return fetch(`${this.baseUrl}/cards/${e}`,{method:"DELETE",headers:this.headers}).then(this._checkResponse)}addLike(e){return fetch(`${this.baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this.headers}).then(this._checkResponse)}removeLike(e){return fetch(`${this.baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this.headers}).then(this._checkResponse)}updateAvatar(e){return fetch(`${this.baseUrl}/users/me/avatar`,{method:"PATCH",headers:this.headers,body:JSON.stringify({avatar:e})}).then(this._checkResponse)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"eb9bb101-c854-4169-9f87-c5a28a8b7a33","Content-Type":"application/json"}}),i={name:"Bessie Coleman",about:"Civil Aviator",avatar:r(117)},l=document.querySelector(".profile__edit-btn"),d=document.querySelector(".profile__add-btn"),u=document.querySelector(".profile__name"),m=document.querySelector(".profile__description"),h=document.querySelector(".profile__avatar"),p=document.querySelector("#edit-modal"),v=document.querySelector("#add-card-modal"),f=document.querySelector("#preview-modal"),_=document.querySelector("#avatar-modal"),y=document.querySelector("#delete-modal"),b=document.forms["edit-profile-form"],k=document.forms["card-form"],S=document.forms["avatar-form"],L=document.forms["delete-form"],g=p.querySelector(".modal__close-btn"),q=v.querySelector(".modal__close-btn"),E=f.querySelector(".modal__close-btn"),w=_.querySelector(".modal__close-btn"),C=y.querySelector(".modal__close-btn"),x=y.querySelector(".modal__cancel-btn"),U=p.querySelector("#profile-name-input"),$=p.querySelector("#profile-description-input"),A=v.querySelector("#add-card-link-input"),T=v.querySelector("#card-caption-input"),j=_.querySelector("#avatar-url-input"),z=document.querySelector(".profile__edit-avatar-link"),R=document.querySelector(".profile__avatar-container"),D=document.querySelector("#card-template"),I=document.querySelector(".cards__list"),B=document.querySelector(".modal__image"),P=document.querySelector(".modal__caption");let F=null,N=null;function O(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"prepend";const r=function(e){const t=D.content.querySelector(".card").cloneNode(!0),r=t.querySelector(".card__title"),n=t.querySelector(".card__image"),o=t.querySelector(".card__like-btn"),a=t.querySelector(".card__delete-btn");return r.textContent=e.name,n.src=e.link,n.alt=e.name,e.isLiked&&o.classList.add("card__like-btn_liked"),a.addEventListener("click",(()=>function(e,t){F=e,N=t._id,H(y)}(t,e))),o.addEventListener("click",(()=>{return t=o,r=e._id,void(t.classList.contains("card__like-btn_liked")?c.removeLike:c.addLike)(r).then((e=>{t.classList.toggle("card__like-btn_liked",e.isLiked)})).catch((e=>console.error("Failed to update like:",e)));var t,r})),n.addEventListener("click",(()=>{B.src=e.link,B.alt=e.name,P.textContent=e.name,H(f)})),t}(e);I[t](r)}function H(e){e.classList.add("modal_opened"),document.addEventListener("keydown",G),e.addEventListener("mousedown",M),R.classList.remove("profile__avatar-container--active")}function J(e){e.classList.remove("modal_opened"),document.removeEventListener("keydown",G),e.removeEventListener("mousedown",M),R.classList.remove("profile__avatar-container--active")}function G(e){if("Escape"===e.key){const e=document.querySelector(".modal_opened");e&&J(e)}}function M(e){e.target.classList.contains("modal")&&J(e.target)}var V;u.textContent=i.name,m.textContent=i.about,h.src=i.avatar,[{name:"Val Thorens",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/1-photo-by-moritz-feldmann-from-pexels.jpg"},{name:"Restaurant terrace",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/2-photo-by-ceiline-from-pexels.jpg"},{name:"An outdoor cafe",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/3-photo-by-tubanur-dogan-from-pexels.jpg"},{name:"A very long bridge, over the forest and through the trees",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/4-photo-by-maurice-laschet-from-pexels.jpg"},{name:"Tunnel with morning light",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/5-photo-by-van-anh-nguyen-from-pexels.jpg"},{name:"Mountain house",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/6-photo-by-moritz-feldmann-from-pexels.jpg"},{name:"Golden Gate bridge",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/7-photo-by-griffin-wooldridge-from-pexels.jpg"}].forEach((e=>O(e,"append"))),l.addEventListener("click",(()=>{U.value=u.textContent,$.value=m.textContent,s(b,n),H(p)})),d.addEventListener("click",(()=>H(v))),z.addEventListener("click",(e=>{e.preventDefault(),j.value=h.src,s(S,n),H(_)})),g.addEventListener("click",(()=>J(p))),q.addEventListener("click",(()=>J(v))),E.addEventListener("click",(()=>J(f))),w.addEventListener("click",(()=>J(_))),C.addEventListener("click",(()=>J(y))),x.addEventListener("click",(()=>J(y))),b.addEventListener("submit",(function(e){e.preventDefault();const t=U.value,r=$.value;c.editUserInfo({name:t,about:r}).then((e=>{u.textContent=e.name,m.textContent=e.about,J(p)})).catch((e=>console.error("Failed to update profile:",e)))})),k.addEventListener("submit",(function(e){e.preventDefault();const t=T.value,r=A.value;c.addCard({name:t,link:r}).then((t=>{O(t),J(v),k.reset(),a([T,A],e.submitter,n)})).catch((e=>console.error("Failed to add card:",e)))})),S.addEventListener("submit",(function(e){e.preventDefault();const t=j.value;c.updateAvatar(t).then((e=>{h.src=e.avatar,J(_)})).catch((e=>console.error("Failed to update avatar:",e)))})),L.addEventListener("submit",(function(e){e.preventDefault(),c.removeCard(N).then((()=>{F.remove(),J(y),F=null,N=null})).catch((e=>console.error("Failed to delete card:",e)))})),R.addEventListener("touchstart",(e=>{R.classList.toggle("profile__avatar-container--active")})),document.addEventListener("touchstart",(e=>{R.contains(e.target)||R.classList.remove("profile__avatar-container--active")})),V=n,document.querySelectorAll(V.formSelector).forEach((e=>((e,t)=>{const r=Array.from(e.querySelectorAll(t.inputSelector)),n=e.querySelector(t.submitButtonSelector);a(r,n,t),e.addEventListener("reset",(()=>{a(r,n,t)})),r.forEach((s=>{s.addEventListener("input",(()=>{((e,t,r)=>{t.validity.valid?o(e,t,r):((e,t,r,n)=>{e.querySelector(`#${t.id}-error`).textContent=r,t.classList.add(n.inputErrorClass)})(e,t,t.validationMessage,r)})(e,s,t),a(r,n,t)}))}))})(e,V)))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEVBQVFFLEkiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvd2VicGFjay9ydW50aW1lL3B1YmxpY1BhdGgiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy9zY3JpcHRzL3ZhbGlkYXRpb24uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3V0aWxzL0FwaS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHR2YXIgY2FjaGVkTW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXTtcblx0aWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0cmV0dXJuIGNhY2hlZE1vZHVsZS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdKG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuIiwiX193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjsiLCJjb25zdCBzZXR0aW5ncyA9IHtcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19zdWJtaXQtYnRuXCIsXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX3N1Ym1pdC1idG5fZGlzYWJsZWRcIixcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF90eXBlX2Vycm9yXCIsXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yXCIsXG59O1xuXG5jb25zdCBzaG93SW5wdXRFcnJvciA9IChmb3JtRWwsIGlucHV0RWwsIGVycm9yTXNnLCBjb25maWcpID0+IHtcbiAgY29uc3QgZXJyb3JNc2dFbCA9IGZvcm1FbC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsLmlkfS1lcnJvcmApO1xuICBlcnJvck1zZ0VsLnRleHRDb250ZW50ID0gZXJyb3JNc2c7XG4gIGlucHV0RWwuY2xhc3NMaXN0LmFkZChjb25maWcuaW5wdXRFcnJvckNsYXNzKTtcbn07XG5cbmNvbnN0IGhpZGVJbnB1dEVycm9yID0gKGZvcm1FbCwgaW5wdXRFbCwgY29uZmlnKSA9PiB7XG4gIGNvbnN0IGVycm9yTXNnRWwgPSBmb3JtRWwucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbC5pZH0tZXJyb3JgKTtcbiAgZXJyb3JNc2dFbC50ZXh0Q29udGVudCA9IFwiXCI7XG4gIGlucHV0RWwuY2xhc3NMaXN0LnJlbW92ZShjb25maWcuaW5wdXRFcnJvckNsYXNzKTtcbn07XG5cbmNvbnN0IGNoZWNrSW5wdXRWYWxpZGl0eSA9IChmb3JtRWwsIGlucHV0RWwsIGNvbmZpZykgPT4ge1xuICBpZiAoIWlucHV0RWwudmFsaWRpdHkudmFsaWQpIHtcbiAgICBzaG93SW5wdXRFcnJvcihmb3JtRWwsIGlucHV0RWwsIGlucHV0RWwudmFsaWRhdGlvbk1lc3NhZ2UsIGNvbmZpZyk7XG4gIH0gZWxzZSB7XG4gICAgaGlkZUlucHV0RXJyb3IoZm9ybUVsLCBpbnB1dEVsLCBjb25maWcpO1xuICB9XG59O1xuXG5jb25zdCBoYXNJbnZhbGlkSW5wdXQgPSAoaW5wdXRMaXN0KSA9PiB7XG4gIHJldHVybiBpbnB1dExpc3Quc29tZSgoaW5wdXQpID0+ICFpbnB1dC52YWxpZGl0eS52YWxpZCk7XG59O1xuXG5jb25zdCB0b2dnbGVCdXR0b25TdGF0ZSA9IChpbnB1dExpc3QsIGJ1dHRvbkVsLCBjb25maWcpID0+IHtcbiAgaWYgKGhhc0ludmFsaWRJbnB1dChpbnB1dExpc3QpKSB7XG4gICAgYnV0dG9uRWwuZGlzYWJsZWQgPSB0cnVlO1xuICAgIGJ1dHRvbkVsLmNsYXNzTGlzdC5hZGQoY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICB9IGVsc2Uge1xuICAgIGJ1dHRvbkVsLmRpc2FibGVkID0gZmFsc2U7XG4gICAgYnV0dG9uRWwuY2xhc3NMaXN0LnJlbW92ZShjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gIH1cbn07XG5cbmNvbnN0IHJlc2V0VmFsaWRhdGlvbiA9IChmb3JtRWwsIGNvbmZpZykgPT4ge1xuICBjb25zdCBpbnB1dExpc3QgPSBBcnJheS5mcm9tKGZvcm1FbC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5pbnB1dFNlbGVjdG9yKSk7XG4gIGlucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsKSA9PiBoaWRlSW5wdXRFcnJvcihmb3JtRWwsIGlucHV0RWwsIGNvbmZpZykpO1xufTtcblxuY29uc3Qgc2V0RXZlbnRMaXN0ZW5lcnMgPSAoZm9ybUVsLCBjb25maWcpID0+IHtcbiAgY29uc3QgaW5wdXRMaXN0ID0gQXJyYXkuZnJvbShmb3JtRWwucXVlcnlTZWxlY3RvckFsbChjb25maWcuaW5wdXRTZWxlY3RvcikpO1xuICBjb25zdCBidXR0b25FbGVtZW50ID0gZm9ybUVsLnF1ZXJ5U2VsZWN0b3IoY29uZmlnLnN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcblxuICB0b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIGNvbmZpZyk7XG5cbiAgZm9ybUVsLmFkZEV2ZW50TGlzdGVuZXIoXCJyZXNldFwiLCAoKSA9PiB7XG4gICAgdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBjb25maWcpO1xuICB9KTtcblxuICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XG4gICAgICBjaGVja0lucHV0VmFsaWRpdHkoZm9ybUVsLCBpbnB1dEVsZW1lbnQsIGNvbmZpZyk7XG4gICAgICB0b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIGNvbmZpZyk7XG4gICAgfSk7XG4gIH0pO1xufTtcblxuY29uc3QgZW5hYmxlVmFsaWRhdGlvbiA9IChjb25maWcpID0+IHtcbiAgY29uc3QgZm9ybUxpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5mb3JtU2VsZWN0b3IpO1xuICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWwpID0+IHNldEV2ZW50TGlzdGVuZXJzKGZvcm1FbCwgY29uZmlnKSk7XG59O1xuXG4vLyBFeHBvcnQgdGhlIG5lY2Vzc2FyeSBmdW5jdGlvbnMgYW5kIHNldHRpbmdzXG5leHBvcnQgeyBlbmFibGVWYWxpZGF0aW9uLCBzZXR0aW5ncywgcmVzZXRWYWxpZGF0aW9uLCB0b2dnbGVCdXR0b25TdGF0ZSB9OyAvLyBBZGRlZCB0b2dnbGVCdXR0b25TdGF0ZVxuIiwiaW1wb3J0IFwiLi9pbmRleC5jc3NcIjsgLy8gSW1wb3J0IGluZGV4LmNzcyBmcm9tIHRoZSBzYW1lIGZvbGRlciAoc3JjL3BhZ2VzLylcbmltcG9ydCB7XG4gIGVuYWJsZVZhbGlkYXRpb24sXG4gIHNldHRpbmdzLFxuICByZXNldFZhbGlkYXRpb24sXG4gIHRvZ2dsZUJ1dHRvblN0YXRlLFxufSBmcm9tIFwiLi4vc2NyaXB0cy92YWxpZGF0aW9uLmpzXCI7XG5pbXBvcnQgQXBpIGZyb20gXCIuLi91dGlscy9BcGkuanNcIjtcblxuY29uc3QgYXBpID0gbmV3IEFwaSh7XG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIixcbiAgaGVhZGVyczoge1xuICAgIGF1dGhvcml6YXRpb246IFwiZWI5YmIxMDEtYzg1NC00MTY5LTlmODctYzVhMjhhOGI3YTMzXCIsXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gIH0sXG59KTtcblxuLy8gRGVmYXVsdCB1c2VyIGRhdGEgYW5kIGluaXRpYWwgY2FyZHNcbmNvbnN0IGRlZmF1bHRVc2VyID0ge1xuICBuYW1lOiBcIkJlc3NpZSBDb2xlbWFuXCIsXG4gIGFib3V0OiBcIkNpdmlsIEF2aWF0b3JcIixcbiAgYXZhdGFyOiByZXF1aXJlKFwiLi4vaW1hZ2VzL2F2YXRhci5qcGdcIiksIC8vIFVzZSB0aGUgZGVmYXVsdCBhdmF0YXIgZnJvbSB5b3VyIEhUTUxcbn07XG5cbmNvbnN0IGluaXRpYWxDYXJkcyA9IFtcbiAge1xuICAgIG5hbWU6IFwiVmFsIFRob3JlbnNcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvMS1waG90by1ieS1tb3JpdHotZmVsZG1hbm4tZnJvbS1wZXhlbHMuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIlJlc3RhdXJhbnQgdGVycmFjZVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy8yLXBob3RvLWJ5LWNlaWxpbmUtZnJvbS1wZXhlbHMuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkFuIG91dGRvb3IgY2FmZVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy8zLXBob3RvLWJ5LXR1YmFudXItZG9nYW4tZnJvbS1wZXhlbHMuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkEgdmVyeSBsb25nIGJyaWRnZSwgb3ZlciB0aGUgZm9yZXN0IGFuZCB0aHJvdWdoIHRoZSB0cmVlc1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy80LXBob3RvLWJ5LW1hdXJpY2UtbGFzY2hldC1mcm9tLXBleGVscy5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiVHVubmVsIHdpdGggbW9ybmluZyBsaWdodFwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy81LXBob3RvLWJ5LXZhbi1hbmgtbmd1eWVuLWZyb20tcGV4ZWxzLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJNb3VudGFpbiBob3VzZVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy82LXBob3RvLWJ5LW1vcml0ei1mZWxkbWFubi1mcm9tLXBleGVscy5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiR29sZGVuIEdhdGUgYnJpZGdlXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzctcGhvdG8tYnktZ3JpZmZpbi13b29sZHJpZGdlLWZyb20tcGV4ZWxzLmpwZ1wiLFxuICB9LFxuXTtcblxuLy8gRE9NIEVsZW1lbnRzXG5jb25zdCBwcm9maWxlRWRpdEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZWRpdC1idG5cIik7XG5jb25zdCBjYXJkTW9kYWxCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idG5cIik7XG5jb25zdCBwcm9maWxlTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fbmFtZVwiKTtcbmNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIik7XG5jb25zdCBwcm9maWxlQXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hdmF0YXJcIik7XG5cbmNvbnN0IGVkaXRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdC1tb2RhbFwiKTtcbmNvbnN0IGNhcmRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtbW9kYWxcIik7XG5jb25zdCBwcmV2aWV3TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3ByZXZpZXctbW9kYWxcIik7XG5jb25zdCBhdmF0YXJNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYXZhdGFyLW1vZGFsXCIpO1xuY29uc3QgZGVsZXRlTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2RlbGV0ZS1tb2RhbFwiKTtcblxuY29uc3QgZWRpdEZvcm1FbGVtZW50ID0gZG9jdW1lbnQuZm9ybXNbXCJlZGl0LXByb2ZpbGUtZm9ybVwiXTtcbmNvbnN0IGNhcmRGb3JtID0gZG9jdW1lbnQuZm9ybXNbXCJjYXJkLWZvcm1cIl07XG5jb25zdCBhdmF0YXJGb3JtID0gZG9jdW1lbnQuZm9ybXNbXCJhdmF0YXItZm9ybVwiXTtcbmNvbnN0IGRlbGV0ZUZvcm0gPSBkb2N1bWVudC5mb3Jtc1tcImRlbGV0ZS1mb3JtXCJdO1xuXG5jb25zdCBlZGl0TW9kYWxDbG9zZUJ0biA9IGVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZS1idG5cIik7XG5jb25zdCBjYXJkTW9kYWxDbG9zZUJ0biA9IGNhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZS1idG5cIik7XG5jb25zdCBwcmV2aWV3TW9kYWxDbG9zZUJ0biA9IHByZXZpZXdNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZS1idG5cIik7XG5jb25zdCBhdmF0YXJNb2RhbENsb3NlQnRuID0gYXZhdGFyTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2UtYnRuXCIpO1xuY29uc3QgZGVsZXRlTW9kYWxDbG9zZUJ0biA9IGRlbGV0ZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlLWJ0blwiKTtcbmNvbnN0IGRlbGV0ZU1vZGFsQ2FuY2VsQnRuID0gZGVsZXRlTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2FuY2VsLWJ0blwiKTtcblxuY29uc3QgZWRpdE1vZGFsTmFtZUlucHV0ID0gZWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1uYW1lLWlucHV0XCIpO1xuY29uc3QgZWRpdE1vZGFsRGVzY3JpcHRpb25JbnB1dCA9IGVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFxuICBcIiNwcm9maWxlLWRlc2NyaXB0aW9uLWlucHV0XCJcbik7XG5jb25zdCBjYXJkTGlua0lucHV0ID0gY2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtbGluay1pbnB1dFwiKTtcbmNvbnN0IGNhcmRDYXB0aW9uSW5wdXQgPSBjYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIiNjYXJkLWNhcHRpb24taW5wdXRcIik7XG5jb25zdCBhdmF0YXJVcmxJbnB1dCA9IGF2YXRhck1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjYXZhdGFyLXVybC1pbnB1dFwiKTtcblxuY29uc3QgYXZhdGFyRWRpdExpbmsgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYXZhdGFyLWxpbmtcIik7XG5jb25zdCBhdmF0YXJDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2F2YXRhci1jb250YWluZXJcIik7XG5cbmNvbnN0IGNhcmRUZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC10ZW1wbGF0ZVwiKTtcbmNvbnN0IGNhcmRzTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2xpc3RcIik7XG5cbmNvbnN0IHByZXZpZXdNb2RhbEltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2VcIik7XG5jb25zdCBwcmV2aWV3TW9kYWxDYXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2FwdGlvblwiKTtcblxuLy8gVmFyaWFibGVzIGZvciBkZWxldGUgZnVuY3Rpb25hbGl0eVxubGV0IHNlbGVjdGVkQ2FyZCA9IG51bGw7XG5sZXQgc2VsZWN0ZWRDYXJkSWQgPSBudWxsO1xuXG4vLyBMb2FkIGRlZmF1bHQgZGF0YSBvbiBwYWdlIGxvYWQgKGlnbm9yaW5nIHNlcnZlciBkYXRhKVxuZnVuY3Rpb24gbG9hZERlZmF1bHREYXRhKCkge1xuICBwcm9maWxlTmFtZS50ZXh0Q29udGVudCA9IGRlZmF1bHRVc2VyLm5hbWU7XG4gIHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IGRlZmF1bHRVc2VyLmFib3V0O1xuICBwcm9maWxlQXZhdGFyLnNyYyA9IGRlZmF1bHRVc2VyLmF2YXRhcjtcbiAgaW5pdGlhbENhcmRzLmZvckVhY2goKGl0ZW0pID0+IHJlbmRlckNhcmQoaXRlbSwgXCJhcHBlbmRcIikpO1xufVxuXG4vLyBMb2FkIHRoZSBkZWZhdWx0IGRhdGEgaW1tZWRpYXRlbHkgb24gcGFnZSBsb2FkXG5sb2FkRGVmYXVsdERhdGEoKTtcblxuLy8gQ2FyZCBjcmVhdGlvbiBmdW5jdGlvblxuZnVuY3Rpb24gZ2V0Q2FyZEVsZW1lbnQoZGF0YSkge1xuICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmRUZW1wbGF0ZS5jb250ZW50XG4gICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxuICAgIC5jbG9uZU5vZGUodHJ1ZSk7XG4gIGNvbnN0IGNhcmROYW1lRWwgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RpdGxlXCIpO1xuICBjb25zdCBjYXJkSW1hZ2VFbCA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XG4gIGNvbnN0IGNhcmRMaWtlQnRuID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ0blwiKTtcbiAgY29uc3QgY2FyZERlbGV0ZUJ0biA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlLWJ0blwiKTtcblxuICBjYXJkTmFtZUVsLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xuICBjYXJkSW1hZ2VFbC5zcmMgPSBkYXRhLmxpbms7XG4gIGNhcmRJbWFnZUVsLmFsdCA9IGRhdGEubmFtZTtcbiAgaWYgKGRhdGEuaXNMaWtlZCkgY2FyZExpa2VCdG4uY2xhc3NMaXN0LmFkZChcImNhcmRfX2xpa2UtYnRuX2xpa2VkXCIpO1xuXG4gIGNhcmREZWxldGVCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+XG4gICAgaGFuZGxlRGVsZXRlQ2FyZChjYXJkRWxlbWVudCwgZGF0YSlcbiAgKTtcbiAgY2FyZExpa2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+XG4gICAgaGFuZGxlTGlrZUNsaWNrKGNhcmRMaWtlQnRuLCBkYXRhLl9pZClcbiAgKTtcbiAgY2FyZEltYWdlRWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICBwcmV2aWV3TW9kYWxJbWFnZS5zcmMgPSBkYXRhLmxpbms7XG4gICAgcHJldmlld01vZGFsSW1hZ2UuYWx0ID0gZGF0YS5uYW1lO1xuICAgIHByZXZpZXdNb2RhbENhcHRpb24udGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XG4gICAgb3Blbk1vZGFsKHByZXZpZXdNb2RhbCk7XG4gIH0pO1xuXG4gIHJldHVybiBjYXJkRWxlbWVudDtcbn1cblxuZnVuY3Rpb24gcmVuZGVyQ2FyZChpdGVtLCBtZXRob2QgPSBcInByZXBlbmRcIikge1xuICBjb25zdCBjYXJkRWxlbWVudCA9IGdldENhcmRFbGVtZW50KGl0ZW0pO1xuICBjYXJkc0xpc3RbbWV0aG9kXShjYXJkRWxlbWVudCk7XG59XG5cbi8vIE1vZGFsIGZ1bmN0aW9uc1xuZnVuY3Rpb24gb3Blbk1vZGFsKG1vZGFsKSB7XG4gIG1vZGFsLmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XG4gIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGNsb3NlTW9kYWxCeUVzY2FwZSk7XG4gIG1vZGFsLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgY2xvc2VNb2RhbEJ5T3ZlcmxheUNsaWNrKTtcbiAgYXZhdGFyQ29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoXCJwcm9maWxlX19hdmF0YXItY29udGFpbmVyLS1hY3RpdmVcIik7XG59XG5cbmZ1bmN0aW9uIGNsb3NlTW9kYWwobW9kYWwpIHtcbiAgbW9kYWwuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcbiAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgY2xvc2VNb2RhbEJ5RXNjYXBlKTtcbiAgbW9kYWwucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCBjbG9zZU1vZGFsQnlPdmVybGF5Q2xpY2spO1xuICBhdmF0YXJDb250YWluZXIuY2xhc3NMaXN0LnJlbW92ZShcInByb2ZpbGVfX2F2YXRhci1jb250YWluZXItLWFjdGl2ZVwiKTtcbn1cblxuLy8gRm9ybSBoYW5kbGVyc1xuZnVuY3Rpb24gaGFuZGxlRWRpdEZvcm1TdWJtaXQoZXZ0KSB7XG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICBjb25zdCBuYW1lID0gZWRpdE1vZGFsTmFtZUlucHV0LnZhbHVlO1xuICBjb25zdCBhYm91dCA9IGVkaXRNb2RhbERlc2NyaXB0aW9uSW5wdXQudmFsdWU7XG4gIGFwaVxuICAgIC5lZGl0VXNlckluZm8oeyBuYW1lLCBhYm91dCB9KVxuICAgIC50aGVuKCh1c2VyKSA9PiB7XG4gICAgICBwcm9maWxlTmFtZS50ZXh0Q29udGVudCA9IHVzZXIubmFtZTtcbiAgICAgIHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IHVzZXIuYWJvdXQ7XG4gICAgICBjbG9zZU1vZGFsKGVkaXRNb2RhbCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byB1cGRhdGUgcHJvZmlsZTpcIiwgZXJyKSk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUFkZENhcmRTdWJtaXQoZXZ0KSB7XG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICBjb25zdCBuYW1lID0gY2FyZENhcHRpb25JbnB1dC52YWx1ZTtcbiAgY29uc3QgbGluayA9IGNhcmRMaW5rSW5wdXQudmFsdWU7XG4gIGFwaVxuICAgIC5hZGRDYXJkKHsgbmFtZSwgbGluayB9KVxuICAgIC50aGVuKChjYXJkKSA9PiB7XG4gICAgICByZW5kZXJDYXJkKGNhcmQpO1xuICAgICAgY2xvc2VNb2RhbChjYXJkTW9kYWwpO1xuICAgICAgY2FyZEZvcm0ucmVzZXQoKTtcbiAgICAgIHRvZ2dsZUJ1dHRvblN0YXRlKFxuICAgICAgICBbY2FyZENhcHRpb25JbnB1dCwgY2FyZExpbmtJbnB1dF0sXG4gICAgICAgIGV2dC5zdWJtaXR0ZXIsXG4gICAgICAgIHNldHRpbmdzXG4gICAgICApO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gYWRkIGNhcmQ6XCIsIGVycikpO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVBdmF0YXJGb3JtU3VibWl0KGV2dCkge1xuICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgY29uc3QgYXZhdGFyVXJsID0gYXZhdGFyVXJsSW5wdXQudmFsdWU7XG4gIGFwaVxuICAgIC51cGRhdGVBdmF0YXIoYXZhdGFyVXJsKVxuICAgIC50aGVuKCh1c2VyKSA9PiB7XG4gICAgICBwcm9maWxlQXZhdGFyLnNyYyA9IHVzZXIuYXZhdGFyO1xuICAgICAgY2xvc2VNb2RhbChhdmF0YXJNb2RhbCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byB1cGRhdGUgYXZhdGFyOlwiLCBlcnIpKTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlRGVsZXRlQ2FyZChjYXJkRWxlbWVudCwgZGF0YSkge1xuICBzZWxlY3RlZENhcmQgPSBjYXJkRWxlbWVudDtcbiAgc2VsZWN0ZWRDYXJkSWQgPSBkYXRhLl9pZDtcbiAgb3Blbk1vZGFsKGRlbGV0ZU1vZGFsKTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlRGVsZXRlU3VibWl0KGV2dCkge1xuICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgYXBpXG4gICAgLnJlbW92ZUNhcmQoc2VsZWN0ZWRDYXJkSWQpXG4gICAgLnRoZW4oKCkgPT4ge1xuICAgICAgc2VsZWN0ZWRDYXJkLnJlbW92ZSgpO1xuICAgICAgY2xvc2VNb2RhbChkZWxldGVNb2RhbCk7XG4gICAgICBzZWxlY3RlZENhcmQgPSBudWxsO1xuICAgICAgc2VsZWN0ZWRDYXJkSWQgPSBudWxsO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gZGVsZXRlIGNhcmQ6XCIsIGVycikpO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVMaWtlQ2xpY2sobGlrZUJ0biwgY2FyZElkKSB7XG4gIGNvbnN0IGlzTGlrZWQgPSBsaWtlQnRuLmNsYXNzTGlzdC5jb250YWlucyhcImNhcmRfX2xpa2UtYnRuX2xpa2VkXCIpO1xuICBjb25zdCBtZXRob2QgPSBpc0xpa2VkID8gYXBpLnJlbW92ZUxpa2UgOiBhcGkuYWRkTGlrZTtcbiAgbWV0aG9kKGNhcmRJZClcbiAgICAudGhlbigodXBkYXRlZENhcmQpID0+IHtcbiAgICAgIGxpa2VCdG4uY2xhc3NMaXN0LnRvZ2dsZShcImNhcmRfX2xpa2UtYnRuX2xpa2VkXCIsIHVwZGF0ZWRDYXJkLmlzTGlrZWQpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gdXBkYXRlIGxpa2U6XCIsIGVycikpO1xufVxuXG4vLyBFdmVudCBsaXN0ZW5lcnNcbnByb2ZpbGVFZGl0QnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGVkaXRNb2RhbE5hbWVJbnB1dC52YWx1ZSA9IHByb2ZpbGVOYW1lLnRleHRDb250ZW50O1xuICBlZGl0TW9kYWxEZXNjcmlwdGlvbklucHV0LnZhbHVlID0gcHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50O1xuICByZXNldFZhbGlkYXRpb24oZWRpdEZvcm1FbGVtZW50LCBzZXR0aW5ncyk7XG4gIG9wZW5Nb2RhbChlZGl0TW9kYWwpO1xufSk7XG5cbmNhcmRNb2RhbEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gb3Blbk1vZGFsKGNhcmRNb2RhbCkpO1xuYXZhdGFyRWRpdExpbmsuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+IHtcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gIGF2YXRhclVybElucHV0LnZhbHVlID0gcHJvZmlsZUF2YXRhci5zcmM7XG4gIHJlc2V0VmFsaWRhdGlvbihhdmF0YXJGb3JtLCBzZXR0aW5ncyk7XG4gIG9wZW5Nb2RhbChhdmF0YXJNb2RhbCk7XG59KTtcblxuZWRpdE1vZGFsQ2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IGNsb3NlTW9kYWwoZWRpdE1vZGFsKSk7XG5jYXJkTW9kYWxDbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gY2xvc2VNb2RhbChjYXJkTW9kYWwpKTtcbnByZXZpZXdNb2RhbENsb3NlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiBjbG9zZU1vZGFsKHByZXZpZXdNb2RhbCkpO1xuYXZhdGFyTW9kYWxDbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gY2xvc2VNb2RhbChhdmF0YXJNb2RhbCkpO1xuZGVsZXRlTW9kYWxDbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gY2xvc2VNb2RhbChkZWxldGVNb2RhbCkpO1xuZGVsZXRlTW9kYWxDYW5jZWxCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IGNsb3NlTW9kYWwoZGVsZXRlTW9kYWwpKTtcblxuZWRpdEZvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlRWRpdEZvcm1TdWJtaXQpO1xuY2FyZEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVBZGRDYXJkU3VibWl0KTtcbmF2YXRhckZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVBdmF0YXJGb3JtU3VibWl0KTtcbmRlbGV0ZUZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVEZWxldGVTdWJtaXQpO1xuXG4vLyBUb3VjaCBldmVudHMgZm9yIGF2YXRhclxuYXZhdGFyQ29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaHN0YXJ0XCIsIChldnQpID0+IHtcbiAgYXZhdGFyQ29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoXCJwcm9maWxlX19hdmF0YXItY29udGFpbmVyLS1hY3RpdmVcIik7XG59KTtcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaHN0YXJ0XCIsIChldnQpID0+IHtcbiAgaWYgKCFhdmF0YXJDb250YWluZXIuY29udGFpbnMoZXZ0LnRhcmdldCkpIHtcbiAgICBhdmF0YXJDb250YWluZXIuY2xhc3NMaXN0LnJlbW92ZShcInByb2ZpbGVfX2F2YXRhci1jb250YWluZXItLWFjdGl2ZVwiKTtcbiAgfVxufSk7XG5cbmZ1bmN0aW9uIGNsb3NlTW9kYWxCeUVzY2FwZShldnQpIHtcbiAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcbiAgICBjb25zdCBvcGVuZWRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfb3BlbmVkXCIpO1xuICAgIGlmIChvcGVuZWRNb2RhbCkgY2xvc2VNb2RhbChvcGVuZWRNb2RhbCk7XG4gIH1cbn1cblxuZnVuY3Rpb24gY2xvc2VNb2RhbEJ5T3ZlcmxheUNsaWNrKGV2dCkge1xuICBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbFwiKSkge1xuICAgIGNsb3NlTW9kYWwoZXZ0LnRhcmdldCk7XG4gIH1cbn1cblxuZW5hYmxlVmFsaWRhdGlvbihzZXR0aW5ncyk7XG4iLCIvLyB1dGlscy9BcGkuanNcblxuY2xhc3MgQXBpIHtcbiAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBoZWFkZXJzIH0pIHtcbiAgICB0aGlzLmJhc2VVcmwgPSBiYXNlVXJsO1xuICAgIHRoaXMuaGVhZGVycyA9IGhlYWRlcnM7XG4gIH1cblxuICAvLyBIZWxwZXIgbWV0aG9kIHRvIGhhbmRsZSByZXNwb25zZXNcbiAgX2NoZWNrUmVzcG9uc2UocmVzKSB7XG4gICAgaWYgKCFyZXMub2spIHtcbiAgICAgIHJldHVybiByZXMudGV4dCgpLnRoZW4oKHRleHQpID0+IHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBIVFRQIGVycm9yISBTdGF0dXM6ICR7cmVzLnN0YXR1c30gLSAke3RleHR9YCk7XG4gICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gIH1cblxuICAvLyBGZXRjaCB1c2VyIGluZm8gYW5kIGNhcmRzIHRvZ2V0aGVyXG4gIGdldEFwcEluZm8oKSB7XG4gICAgcmV0dXJuIFByb21pc2UuYWxsKFt0aGlzLmdldFVzZXJJbmZvKCksIHRoaXMuZ2V0SW5pdGlhbENhcmRzKCldKS50aGVuKFxuICAgICAgKFt1c2VyLCBjYXJkc10pID0+ICh7IHVzZXIsIGNhcmRzIH0pXG4gICAgKTtcbiAgfVxuXG4gIC8vIEZldGNoIHVzZXIgaW5mb1xuICBnZXRVc2VySW5mbygpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgLy8gRmV0Y2ggaW5pdGlhbCBjYXJkc1xuICBnZXRJbml0aWFsQ2FyZHMoKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIC8vIEVkaXQgcHJvZmlsZSB0ZXh0XG4gIGVkaXRVc2VySW5mbyh7IG5hbWUsIGFib3V0IH0pIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBuYW1lLCBhYm91dCB9KSxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgLy8gQWRkIGEgbmV3IGNhcmRcbiAgYWRkQ2FyZCh7IG5hbWUsIGxpbmsgfSkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L2NhcmRzYCwge1xuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgbmFtZSwgbGluayB9KSxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgLy8gRGVsZXRlIGEgY2FyZFxuICByZW1vdmVDYXJkKGNhcmRJZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfWAsIHtcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgLy8gQWRkIGEgbGlrZVxuICBhZGRMaWtlKGNhcmRJZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgLy8gUmVtb3ZlIGEgbGlrZVxuICByZW1vdmVMaWtlKGNhcmRJZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgLy8gVXBkYXRlIGF2YXRhclxuICB1cGRhdGVBdmF0YXIoYXZhdGFyVXJsKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IGF2YXRhcjogYXZhdGFyVXJsIH0pLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgQXBpO1xuIl0sIm5hbWVzIjpbIl9fd2VicGFja19tb2R1bGVfY2FjaGVfXyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImNhY2hlZE1vZHVsZSIsInVuZGVmaW5lZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJfX3dlYnBhY2tfbW9kdWxlc19fIiwicCIsInNldHRpbmdzIiwiZm9ybVNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJoaWRlSW5wdXRFcnJvciIsImZvcm1FbCIsImlucHV0RWwiLCJjb25maWciLCJxdWVyeVNlbGVjdG9yIiwiaWQiLCJ0ZXh0Q29udGVudCIsImNsYXNzTGlzdCIsInJlbW92ZSIsInRvZ2dsZUJ1dHRvblN0YXRlIiwiaW5wdXRMaXN0IiwiYnV0dG9uRWwiLCJzb21lIiwiaW5wdXQiLCJ2YWxpZGl0eSIsInZhbGlkIiwiaGFzSW52YWxpZElucHV0IiwiZGlzYWJsZWQiLCJhZGQiLCJyZXNldFZhbGlkYXRpb24iLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9yRWFjaCIsImFwaSIsImNvbnN0cnVjdG9yIiwiX3JlZiIsImJhc2VVcmwiLCJoZWFkZXJzIiwidGhpcyIsIl9jaGVja1Jlc3BvbnNlIiwicmVzIiwib2siLCJqc29uIiwidGV4dCIsInRoZW4iLCJFcnJvciIsInN0YXR1cyIsImdldEFwcEluZm8iLCJQcm9taXNlIiwiYWxsIiwiZ2V0VXNlckluZm8iLCJnZXRJbml0aWFsQ2FyZHMiLCJfcmVmMiIsInVzZXIiLCJjYXJkcyIsImZldGNoIiwiZWRpdFVzZXJJbmZvIiwiX3JlZjMiLCJuYW1lIiwiYWJvdXQiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImFkZENhcmQiLCJfcmVmNCIsImxpbmsiLCJyZW1vdmVDYXJkIiwiY2FyZElkIiwiYWRkTGlrZSIsInJlbW92ZUxpa2UiLCJ1cGRhdGVBdmF0YXIiLCJhdmF0YXJVcmwiLCJhdmF0YXIiLCJhdXRob3JpemF0aW9uIiwiZGVmYXVsdFVzZXIiLCJyZXF1aXJlIiwicHJvZmlsZUVkaXRCdG4iLCJkb2N1bWVudCIsImNhcmRNb2RhbEJ0biIsInByb2ZpbGVOYW1lIiwicHJvZmlsZURlc2NyaXB0aW9uIiwicHJvZmlsZUF2YXRhciIsImVkaXRNb2RhbCIsImNhcmRNb2RhbCIsInByZXZpZXdNb2RhbCIsImF2YXRhck1vZGFsIiwiZGVsZXRlTW9kYWwiLCJlZGl0Rm9ybUVsZW1lbnQiLCJmb3JtcyIsImNhcmRGb3JtIiwiYXZhdGFyRm9ybSIsImRlbGV0ZUZvcm0iLCJlZGl0TW9kYWxDbG9zZUJ0biIsImNhcmRNb2RhbENsb3NlQnRuIiwicHJldmlld01vZGFsQ2xvc2VCdG4iLCJhdmF0YXJNb2RhbENsb3NlQnRuIiwiZGVsZXRlTW9kYWxDbG9zZUJ0biIsImRlbGV0ZU1vZGFsQ2FuY2VsQnRuIiwiZWRpdE1vZGFsTmFtZUlucHV0IiwiZWRpdE1vZGFsRGVzY3JpcHRpb25JbnB1dCIsImNhcmRMaW5rSW5wdXQiLCJjYXJkQ2FwdGlvbklucHV0IiwiYXZhdGFyVXJsSW5wdXQiLCJhdmF0YXJFZGl0TGluayIsImF2YXRhckNvbnRhaW5lciIsImNhcmRUZW1wbGF0ZSIsImNhcmRzTGlzdCIsInByZXZpZXdNb2RhbEltYWdlIiwicHJldmlld01vZGFsQ2FwdGlvbiIsInNlbGVjdGVkQ2FyZCIsInNlbGVjdGVkQ2FyZElkIiwicmVuZGVyQ2FyZCIsIml0ZW0iLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJjYXJkRWxlbWVudCIsImRhdGEiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiY2FyZE5hbWVFbCIsImNhcmRJbWFnZUVsIiwiY2FyZExpa2VCdG4iLCJjYXJkRGVsZXRlQnRuIiwic3JjIiwiYWx0IiwiaXNMaWtlZCIsImFkZEV2ZW50TGlzdGVuZXIiLCJfaWQiLCJvcGVuTW9kYWwiLCJoYW5kbGVEZWxldGVDYXJkIiwiaGFuZGxlTGlrZUNsaWNrIiwibGlrZUJ0biIsImNvbnRhaW5zIiwidXBkYXRlZENhcmQiLCJ0b2dnbGUiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJlcnJvciIsImdldENhcmRFbGVtZW50IiwibW9kYWwiLCJjbG9zZU1vZGFsQnlFc2NhcGUiLCJjbG9zZU1vZGFsQnlPdmVybGF5Q2xpY2siLCJjbG9zZU1vZGFsIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImV2dCIsImtleSIsIm9wZW5lZE1vZGFsIiwidGFyZ2V0IiwidmFsdWUiLCJwcmV2ZW50RGVmYXVsdCIsImNhcmQiLCJyZXNldCIsInN1Ym1pdHRlciIsInNldEV2ZW50TGlzdGVuZXJzIiwiYnV0dG9uRWxlbWVudCIsImlucHV0RWxlbWVudCIsImNoZWNrSW5wdXRWYWxpZGl0eSIsInNob3dJbnB1dEVycm9yIiwiZXJyb3JNc2ciLCJ2YWxpZGF0aW9uTWVzc2FnZSJdLCJzb3VyY2VSb290IjoiIn0=