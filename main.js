!function(){"use strict";const e={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__submit-btn",inactiveButtonClass:"modal__submit-btn_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error"},t=(e,t,r)=>{e.querySelector(`#${t.id}-error`).textContent="",t.classList.remove(r.inputErrorClass)},r=(e,t,r)=>{(e=>e.some((e=>!e.validity.valid)))(e)?(t.disabled=!0,t.classList.add(r.inactiveButtonClass)):(t.disabled=!1,t.classList.remove(r.inactiveButtonClass))},n=(e,r)=>{Array.from(e.querySelectorAll(r.inputSelector)).forEach((n=>t(e,n,r)))},o=new class{constructor(e){let{baseUrl:t,headers:r}=e;this.baseUrl=t,this.headers=r}_checkResponse(e){return e.ok?e.json():e.text().then((t=>{throw new Error(`HTTP error! Status: ${e.status} - ${t}`)}))}getAppInfo(){return Promise.all([this.getUserInfo(),this.getInitialCards()]).then((e=>{let[t,r]=e;return{user:t,cards:r}}))}getUserInfo(){return fetch(`${this.baseUrl}/users/me`,{headers:this.headers}).then(this._checkResponse)}getInitialCards(){return fetch(`${this.baseUrl}/cards`,{headers:this.headers}).then(this._checkResponse)}editUserInfo(e){let{name:t,about:r}=e;return fetch(`${this.baseUrl}/users/me`,{method:"PATCH",headers:this.headers,body:JSON.stringify({name:t,about:r})}).then(this._checkResponse)}addCard(e){let{name:t,link:r}=e;return fetch(`${this.baseUrl}/cards`,{method:"POST",headers:this.headers,body:JSON.stringify({name:t,link:r})}).then(this._checkResponse)}removeCard(e){return fetch(`${this.baseUrl}/cards/${e}`,{method:"DELETE",headers:this.headers}).then(this._checkResponse)}addLike(e){return fetch(`${this.baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this.headers}).then(this._checkResponse)}removeLike(e){return fetch(`${this.baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this.headers}).then(this._checkResponse)}updateAvatar(e){return fetch(`${this.baseUrl}/users/me/avatar`,{method:"PATCH",headers:this.headers,body:JSON.stringify({avatar:e})}).then(this._checkResponse)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"eb9bb101-c854-4169-9f87-c5a28a8b7a33","Content-Type":"application/json"}}),a=document.querySelector(".profile__edit-btn"),s=document.querySelector(".profile__add-btn"),c=document.querySelector(".profile__name"),l=document.querySelector(".profile__description"),i=document.querySelector(".profile__avatar"),d=document.querySelector("#edit-modal"),u=document.querySelector("#add-card-modal"),m=document.querySelector("#preview-modal"),h=document.querySelector("#avatar-modal"),_=document.querySelector("#delete-modal"),v=document.forms["edit-profile-form"],p=document.forms["card-form"],f=document.forms["avatar-form"],y=document.forms["delete-form"],b=d.querySelector(".modal__close-btn"),S=u.querySelector(".modal__close-btn"),k=m.querySelector(".modal__close-btn"),L=h.querySelector(".modal__close-btn"),C=_.querySelector(".modal__close-btn"),q=_.querySelector(".modal__cancel-btn"),E=d.querySelector("#profile-name-input"),g=d.querySelector("#profile-description-input"),x=u.querySelector("#add-card-link-input"),$=u.querySelector("#card-caption-input"),U=h.querySelector("#avatar-url-input"),A=document.querySelector(".profile__edit-avatar-link"),I=(document.querySelector(".profile__avatar-container"),document.querySelector("#card-template")),D=document.querySelector(".cards__list"),T=document.querySelector(".modal__image"),w=document.querySelector(".modal__caption");let R=null,P=null,F=null;function B(e){console.log("Creating card with data:",e);const t=I.content.querySelector(".card").cloneNode(!0),r=t.querySelector(".card__title"),n=t.querySelector(".card__image"),o=t.querySelector(".card__like-btn"),a=t.querySelector(".card__delete-btn");r.textContent=e.name,n.src=e.link,n.alt=e.name;const s=e.isLiked;return console.log(`Card ${e._id} isLiked: ${s}`),s&&o.classList.add("card__like-btn_liked"),a.addEventListener("click",(()=>function(e,t){R=e,P=t._id,N(_)}(t,e))),o.addEventListener("click",J.bind(null,o,e)),n.addEventListener("click",(()=>{T.src=e.link,T.alt=e.name,w.textContent=e.name,N(m)})),t}function H(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"prepend";const r=B(e);D[t](r)}function N(e){e.classList.add("modal_opened"),document.addEventListener("keydown",j),e.addEventListener("mousedown",M)}function O(e){e.classList.remove("modal_opened"),document.removeEventListener("keydown",j),e.removeEventListener("mousedown",M)}function J(e,t){const r=e.classList.contains("card__like-btn_liked");console.log(`Like button clicked, isLiked: ${r}, Card ID: ${t._id}`),(r?o.removeLike.bind(o):o.addLike.bind(o))(t._id).then((t=>{console.log("Like update response:",t);const r=t.likes&&t.likes.some((e=>e._id===F));e.classList.toggle("card__like-btn_liked",r)})).catch((e=>console.error("Failed to update like:",e)))}function j(e){if("Escape"===e.key){const e=document.querySelector(".modal_opened");e&&O(e)}}function M(e){e.target.classList.contains("modal")&&O(e.target)}var z;a.addEventListener("click",(()=>{E.value=c.textContent,g.value=l.textContent,n(v,e),N(d)})),s.addEventListener("click",(()=>N(u))),A.addEventListener("click",(t=>{t.preventDefault(),U.value=i.src,n(f,e),N(h)})),b.addEventListener("click",(()=>O(d))),S.addEventListener("click",(()=>O(u))),k.addEventListener("click",(()=>O(m))),L.addEventListener("click",(()=>O(h))),C.addEventListener("click",(()=>O(_))),q.addEventListener("click",(()=>O(_))),v.addEventListener("submit",(function(e){e.preventDefault();const t=e.submitter,r=t.textContent;t.textContent="Saving...";const n=E.value,a=g.value;o.editUserInfo({name:n,about:a}).then((e=>{c.textContent=e.name,l.textContent=e.about,O(d)})).catch((e=>console.error("Failed to update profile:",e))).finally((()=>t.textContent=r))})),p.addEventListener("submit",(function(t){t.preventDefault();const n=t.submitter,a=n.textContent;n.textContent="Saving...";const s=$.value,c=x.value;o.addCard({name:s,link:c}).then((t=>{H(t),O(u),p.reset(),r([$,x],n,e)})).catch((e=>console.error("Failed to add card:",e))).finally((()=>n.textContent=a))})),f.addEventListener("submit",(function(e){e.preventDefault();const t=e.submitter,r=t.textContent;t.textContent="Saving...";const n=U.value;o.updateAvatar(n).then((e=>{i.src=e.avatar,O(h)})).catch((e=>console.error("Failed to update avatar:",e))).finally((()=>t.textContent=r))})),y.addEventListener("submit",(function(e){e.preventDefault();const t=e.submitter,r=t.textContent;t.textContent="Saving...",o.removeCard(P).then((()=>{R.remove(),O(_),R=null,P=null})).catch((e=>console.error("Failed to delete card:",e))).finally((()=>t.textContent=r))})),o.getAppInfo().then((e=>{let{user:t,cards:r}=e;console.log("API User Data:",t),console.log("API Cards Data:",r),F=t._id,c.textContent=t.name,l.textContent=t.about,i.src=t.avatar,D.innerHTML="",r.forEach((e=>H(e,"append")))})).catch((e=>console.error("Failed to load initial data:",e))),z=e,document.querySelectorAll(z.formSelector).forEach((e=>((e,n)=>{const o=Array.from(e.querySelectorAll(n.inputSelector)),a=e.querySelector(n.submitButtonSelector);r(o,a,n),e.addEventListener("reset",(()=>{r(o,a,n)})),o.forEach((s=>{s.addEventListener("input",(()=>{((e,r,n)=>{r.validity.valid?t(e,r,n):((e,t,r,n)=>{e.querySelector(`#${t.id}-error`).textContent=r,t.classList.add(n.inputErrorClass)})(e,r,r.validationMessage,n)})(e,s,n),r(o,a,n)}))}))})(e,z)))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QU9MLGdCQUFnQixFQVczQ2dLLENBQWU3SixFQUFRQyxFQUFTQSxFQUFROEosa0JBQW1CN0osRUFHN0QsRUFrQ0kwSixDQUFtQjVKLEVBQVEySixFQUFjekosR0FDekNNLEVBQWtCQyxFQUFXaUosRUFBZXhKLEVBQU8sR0FDbkQsR0FDRixFQUsyQnVKLENBQWtCekosRUFBUUUsSSIsInNvdXJjZXMiOlsid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvc2NyaXB0cy92YWxpZGF0aW9uLmpzIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy91dGlscy9BcGkuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3Qgc2V0dGluZ3MgPSB7XG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fc3VibWl0LWJ0blwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19zdWJtaXQtYnRuX2Rpc2FibGVkXCIsXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxuICBlcnJvckNsYXNzOiBcIm1vZGFsX19lcnJvclwiLFxufTtcblxuY29uc3Qgc2hvd0lucHV0RXJyb3IgPSAoZm9ybUVsLCBpbnB1dEVsLCBlcnJvck1zZywgY29uZmlnKSA9PiB7XG4gIGNvbnN0IGVycm9yTXNnRWwgPSBmb3JtRWwucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbC5pZH0tZXJyb3JgKTtcbiAgZXJyb3JNc2dFbC50ZXh0Q29udGVudCA9IGVycm9yTXNnO1xuICBpbnB1dEVsLmNsYXNzTGlzdC5hZGQoY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XG59O1xuXG5jb25zdCBoaWRlSW5wdXRFcnJvciA9IChmb3JtRWwsIGlucHV0RWwsIGNvbmZpZykgPT4ge1xuICBjb25zdCBlcnJvck1zZ0VsID0gZm9ybUVsLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7XG4gIGVycm9yTXNnRWwudGV4dENvbnRlbnQgPSBcIlwiO1xuICBpbnB1dEVsLmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XG59O1xuXG5jb25zdCBjaGVja0lucHV0VmFsaWRpdHkgPSAoZm9ybUVsLCBpbnB1dEVsLCBjb25maWcpID0+IHtcbiAgaWYgKCFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgc2hvd0lucHV0RXJyb3IoZm9ybUVsLCBpbnB1dEVsLCBpbnB1dEVsLnZhbGlkYXRpb25NZXNzYWdlLCBjb25maWcpO1xuICB9IGVsc2Uge1xuICAgIGhpZGVJbnB1dEVycm9yKGZvcm1FbCwgaW5wdXRFbCwgY29uZmlnKTtcbiAgfVxufTtcblxuY29uc3QgaGFzSW52YWxpZElucHV0ID0gKGlucHV0TGlzdCkgPT4ge1xuICByZXR1cm4gaW5wdXRMaXN0LnNvbWUoKGlucHV0KSA9PiAhaW5wdXQudmFsaWRpdHkudmFsaWQpO1xufTtcblxuY29uc3QgdG9nZ2xlQnV0dG9uU3RhdGUgPSAoaW5wdXRMaXN0LCBidXR0b25FbCwgY29uZmlnKSA9PiB7XG4gIGlmIChoYXNJbnZhbGlkSW5wdXQoaW5wdXRMaXN0KSkge1xuICAgIGJ1dHRvbkVsLmRpc2FibGVkID0gdHJ1ZTtcbiAgICBidXR0b25FbC5jbGFzc0xpc3QuYWRkKGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgfSBlbHNlIHtcbiAgICBidXR0b25FbC5kaXNhYmxlZCA9IGZhbHNlO1xuICAgIGJ1dHRvbkVsLmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICB9XG59O1xuXG5jb25zdCByZXNldFZhbGlkYXRpb24gPSAoZm9ybUVsLCBjb25maWcpID0+IHtcbiAgY29uc3QgaW5wdXRMaXN0ID0gQXJyYXkuZnJvbShmb3JtRWwucXVlcnlTZWxlY3RvckFsbChjb25maWcuaW5wdXRTZWxlY3RvcikpO1xuICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbCkgPT4gaGlkZUlucHV0RXJyb3IoZm9ybUVsLCBpbnB1dEVsLCBjb25maWcpKTtcbn07XG5cbmNvbnN0IHNldEV2ZW50TGlzdGVuZXJzID0gKGZvcm1FbCwgY29uZmlnKSA9PiB7XG4gIGNvbnN0IGlucHV0TGlzdCA9IEFycmF5LmZyb20oZm9ybUVsLnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLmlucHV0U2VsZWN0b3IpKTtcbiAgY29uc3QgYnV0dG9uRWxlbWVudCA9IGZvcm1FbC5xdWVyeVNlbGVjdG9yKGNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3Rvcik7XG5cbiAgdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBjb25maWcpO1xuXG4gIGZvcm1FbC5hZGRFdmVudExpc3RlbmVyKFwicmVzZXRcIiwgKCkgPT4ge1xuICAgIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgY29uZmlnKTtcbiAgfSk7XG5cbiAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xuICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xuICAgICAgY2hlY2tJbnB1dFZhbGlkaXR5KGZvcm1FbCwgaW5wdXRFbGVtZW50LCBjb25maWcpO1xuICAgICAgdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBjb25maWcpO1xuICAgIH0pO1xuICB9KTtcbn07XG5cbmNvbnN0IGVuYWJsZVZhbGlkYXRpb24gPSAoY29uZmlnKSA9PiB7XG4gIGNvbnN0IGZvcm1MaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChjb25maWcuZm9ybVNlbGVjdG9yKTtcbiAgZm9ybUxpc3QuZm9yRWFjaCgoZm9ybUVsKSA9PiBzZXRFdmVudExpc3RlbmVycyhmb3JtRWwsIGNvbmZpZykpO1xufTtcblxuLy8gRXhwb3J0IHRoZSBuZWNlc3NhcnkgZnVuY3Rpb25zIGFuZCBzZXR0aW5nc1xuZXhwb3J0IHsgZW5hYmxlVmFsaWRhdGlvbiwgc2V0dGluZ3MsIHJlc2V0VmFsaWRhdGlvbiwgdG9nZ2xlQnV0dG9uU3RhdGUgfTsgLy8gQWRkZWQgdG9nZ2xlQnV0dG9uU3RhdGVcbiIsImltcG9ydCBcIi4vaW5kZXguY3NzXCI7XG5pbXBvcnQge1xuICBlbmFibGVWYWxpZGF0aW9uLFxuICBzZXR0aW5ncyxcbiAgcmVzZXRWYWxpZGF0aW9uLFxuICB0b2dnbGVCdXR0b25TdGF0ZSxcbn0gZnJvbSBcIi4uL3NjcmlwdHMvdmFsaWRhdGlvbi5qc1wiO1xuaW1wb3J0IEFwaSBmcm9tIFwiLi4vdXRpbHMvQXBpLmpzXCI7XG5cbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXG4gIGhlYWRlcnM6IHtcbiAgICBhdXRob3JpemF0aW9uOiBcImViOWJiMTAxLWM4NTQtNDE2OS05Zjg3LWM1YTI4YThiN2EzM1wiLFxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICB9LFxufSk7XG5cbi8vIERPTSBFbGVtZW50c1xuY29uc3QgcHJvZmlsZUVkaXRCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYnRuXCIpO1xuY29uc3QgY2FyZE1vZGFsQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnRuXCIpO1xuY29uc3QgcHJvZmlsZU5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX25hbWVcIik7XG5jb25zdCBwcm9maWxlRGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIpO1xuY29uc3QgcHJvZmlsZUF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyXCIpO1xuXG5jb25zdCBlZGl0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2VkaXQtbW9kYWxcIik7XG5jb25zdCBjYXJkTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkLW1vZGFsXCIpO1xuY29uc3QgcHJldmlld01vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcmV2aWV3LW1vZGFsXCIpO1xuY29uc3QgYXZhdGFyTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2F2YXRhci1tb2RhbFwiKTtcbmNvbnN0IGRlbGV0ZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNkZWxldGUtbW9kYWxcIik7XG5cbmNvbnN0IGVkaXRGb3JtRWxlbWVudCA9IGRvY3VtZW50LmZvcm1zW1wiZWRpdC1wcm9maWxlLWZvcm1cIl07XG5jb25zdCBjYXJkRm9ybSA9IGRvY3VtZW50LmZvcm1zW1wiY2FyZC1mb3JtXCJdO1xuY29uc3QgYXZhdGFyRm9ybSA9IGRvY3VtZW50LmZvcm1zW1wiYXZhdGFyLWZvcm1cIl07XG5jb25zdCBkZWxldGVGb3JtID0gZG9jdW1lbnQuZm9ybXNbXCJkZWxldGUtZm9ybVwiXTtcblxuY29uc3QgZWRpdE1vZGFsQ2xvc2VCdG4gPSBlZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2UtYnRuXCIpO1xuY29uc3QgY2FyZE1vZGFsQ2xvc2VCdG4gPSBjYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2UtYnRuXCIpO1xuY29uc3QgcHJldmlld01vZGFsQ2xvc2VCdG4gPSBwcmV2aWV3TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2UtYnRuXCIpO1xuY29uc3QgYXZhdGFyTW9kYWxDbG9zZUJ0biA9IGF2YXRhck1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlLWJ0blwiKTtcbmNvbnN0IGRlbGV0ZU1vZGFsQ2xvc2VCdG4gPSBkZWxldGVNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZS1idG5cIik7XG5jb25zdCBkZWxldGVNb2RhbENhbmNlbEJ0biA9IGRlbGV0ZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2NhbmNlbC1idG5cIik7XG5cbmNvbnN0IGVkaXRNb2RhbE5hbWVJbnB1dCA9IGVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtbmFtZS1pbnB1dFwiKTtcbmNvbnN0IGVkaXRNb2RhbERlc2NyaXB0aW9uSW5wdXQgPSBlZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcbiAgXCIjcHJvZmlsZS1kZXNjcmlwdGlvbi1pbnB1dFwiXG4pO1xuY29uc3QgY2FyZExpbmtJbnB1dCA9IGNhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkLWxpbmstaW5wdXRcIik7XG5jb25zdCBjYXJkQ2FwdGlvbklucHV0ID0gY2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC1jYXB0aW9uLWlucHV0XCIpO1xuY29uc3QgYXZhdGFyVXJsSW5wdXQgPSBhdmF0YXJNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI2F2YXRhci11cmwtaW5wdXRcIik7XG5cbmNvbnN0IGF2YXRhckVkaXRMaW5rID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWF2YXRhci1saW5rXCIpO1xuY29uc3QgYXZhdGFyQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hdmF0YXItY29udGFpbmVyXCIpO1xuXG5jb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtdGVtcGxhdGVcIik7XG5jb25zdCBjYXJkc0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19saXN0XCIpO1xuXG5jb25zdCBwcmV2aWV3TW9kYWxJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2ltYWdlXCIpO1xuY29uc3QgcHJldmlld01vZGFsQ2FwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2NhcHRpb25cIik7XG5cbi8vIFZhcmlhYmxlcyBmb3IgZGVsZXRlIGZ1bmN0aW9uYWxpdHlcbmxldCBzZWxlY3RlZENhcmQgPSBudWxsO1xubGV0IHNlbGVjdGVkQ2FyZElkID0gbnVsbDtcbmxldCB1c2VySWQgPSBudWxsOyAvLyBTdG9yZSB0aGUgY3VycmVudCB1c2VyJ3MgSURcblxuLy8gTG9hZCBpbml0aWFsIGRhdGEgZnJvbSBBUElcbmZ1bmN0aW9uIGxvYWRJbml0aWFsRGF0YSgpIHtcbiAgYXBpXG4gICAgLmdldEFwcEluZm8oKVxuICAgIC50aGVuKCh7IHVzZXIsIGNhcmRzIH0pID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKFwiQVBJIFVzZXIgRGF0YTpcIiwgdXNlcik7XG4gICAgICBjb25zb2xlLmxvZyhcIkFQSSBDYXJkcyBEYXRhOlwiLCBjYXJkcyk7XG4gICAgICB1c2VySWQgPSB1c2VyLl9pZDsgLy8gU3RvcmUgdGhlIGN1cnJlbnQgdXNlcidzIElEXG4gICAgICBwcm9maWxlTmFtZS50ZXh0Q29udGVudCA9IHVzZXIubmFtZTtcbiAgICAgIHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IHVzZXIuYWJvdXQ7XG4gICAgICBwcm9maWxlQXZhdGFyLnNyYyA9IHVzZXIuYXZhdGFyO1xuICAgICAgY2FyZHNMaXN0LmlubmVySFRNTCA9IFwiXCI7IC8vIENsZWFyIGV4aXN0aW5nIGNhcmRzXG4gICAgICBjYXJkcy5mb3JFYWNoKChpdGVtKSA9PiByZW5kZXJDYXJkKGl0ZW0sIFwiYXBwZW5kXCIpKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIGxvYWQgaW5pdGlhbCBkYXRhOlwiLCBlcnIpKTtcbn1cblxuLy8gQ2FyZCBjcmVhdGlvbiBmdW5jdGlvblxuZnVuY3Rpb24gZ2V0Q2FyZEVsZW1lbnQoZGF0YSkge1xuICBjb25zb2xlLmxvZyhcIkNyZWF0aW5nIGNhcmQgd2l0aCBkYXRhOlwiLCBkYXRhKTsgLy8gRGVidWc6IExvZyBjYXJkIGRhdGFcbiAgY29uc3QgY2FyZEVsZW1lbnQgPSBjYXJkVGVtcGxhdGUuY29udGVudFxuICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIilcbiAgICAuY2xvbmVOb2RlKHRydWUpO1xuICBjb25zdCBjYXJkTmFtZUVsID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKTtcbiAgY29uc3QgY2FyZEltYWdlRWwgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xuICBjb25zdCBjYXJkTGlrZUJ0biA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idG5cIik7XG4gIGNvbnN0IGNhcmREZWxldGVCdG4gPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2RlbGV0ZS1idG5cIik7XG5cbiAgY2FyZE5hbWVFbC50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcbiAgY2FyZEltYWdlRWwuc3JjID0gZGF0YS5saW5rO1xuICBjYXJkSW1hZ2VFbC5hbHQgPSBkYXRhLm5hbWU7XG5cbiAgLy8gQ2hlY2sgaWYgdGhlIGN1cnJlbnQgdXNlciBoYXMgbGlrZWQgdGhlIGNhcmRcbiAgLy8gY29uc3QgaXNMaWtlZCA9IGRhdGEubGlrZXMgJiYgZGF0YS5saWtlcy5zb21lKChsaWtlKSA9PiBsaWtlLl9pZCA9PT0gdXNlcklkKTtcbiAgLy8gcHJldmlvdXMgbGluZSBleHBlY3RzIGFwaSByZXNwb25zZSBjYWxsZWQgXCJkYXRhLmxpa2VzXCIgaG93ZXZlciB3ZSBhY3R1YWxseSByZWNlaXZlZFxuICAvLyBkYXRhLmlzTGlrZWQgPSB0cnVlIG9yIGZhbHNlXG4gIGNvbnN0IGlzTGlrZWQgPSBkYXRhLmlzTGlrZWQ7XG4gIGNvbnNvbGUubG9nKGBDYXJkICR7ZGF0YS5faWR9IGlzTGlrZWQ6ICR7aXNMaWtlZH1gKTsgLy8gRGVidWc6IExvZyBpbml0aWFsIGxpa2Ugc3RhdGVcbiAgaWYgKGlzTGlrZWQpIHtcbiAgICBjYXJkTGlrZUJ0bi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGlrZS1idG5fbGlrZWRcIik7XG4gIH1cblxuICBjYXJkRGVsZXRlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PlxuICAgIGhhbmRsZURlbGV0ZUNhcmQoY2FyZEVsZW1lbnQsIGRhdGEpXG4gICk7XG4gIGNhcmRMaWtlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXG4gICAgXCJjbGlja1wiLFxuICAgIGhhbmRsZUxpa2VDbGljay5iaW5kKG51bGwsIGNhcmRMaWtlQnRuLCBkYXRhKVxuICApO1xuICBjYXJkSW1hZ2VFbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgIHByZXZpZXdNb2RhbEltYWdlLnNyYyA9IGRhdGEubGluaztcbiAgICBwcmV2aWV3TW9kYWxJbWFnZS5hbHQgPSBkYXRhLm5hbWU7XG4gICAgcHJldmlld01vZGFsQ2FwdGlvbi50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcbiAgICBvcGVuTW9kYWwocHJldmlld01vZGFsKTtcbiAgfSk7XG5cbiAgcmV0dXJuIGNhcmRFbGVtZW50O1xufVxuXG5mdW5jdGlvbiByZW5kZXJDYXJkKGl0ZW0sIG1ldGhvZCA9IFwicHJlcGVuZFwiKSB7XG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gZ2V0Q2FyZEVsZW1lbnQoaXRlbSk7XG4gIGNhcmRzTGlzdFttZXRob2RdKGNhcmRFbGVtZW50KTtcbn1cblxuLy8gTW9kYWwgZnVuY3Rpb25zXG5mdW5jdGlvbiBvcGVuTW9kYWwobW9kYWwpIHtcbiAgbW9kYWwuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgY2xvc2VNb2RhbEJ5RXNjYXBlKTtcbiAgbW9kYWwuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCBjbG9zZU1vZGFsQnlPdmVybGF5Q2xpY2spO1xufVxuXG5mdW5jdGlvbiBjbG9zZU1vZGFsKG1vZGFsKSB7XG4gIG1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuZWRcIik7XG4gIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGNsb3NlTW9kYWxCeUVzY2FwZSk7XG4gIG1vZGFsLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgY2xvc2VNb2RhbEJ5T3ZlcmxheUNsaWNrKTtcbn1cblxuLy8gRm9ybSBoYW5kbGVycyB3aXRoIFwiU2F2aW5nLi4uXCIgc3RhdGVcbmZ1bmN0aW9uIGhhbmRsZUVkaXRGb3JtU3VibWl0KGV2dCkge1xuICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgY29uc3Qgc3VibWl0QnRuID0gZXZ0LnN1Ym1pdHRlcjtcbiAgY29uc3Qgb3JpZ2luYWxUZXh0ID0gc3VibWl0QnRuLnRleHRDb250ZW50O1xuICBzdWJtaXRCdG4udGV4dENvbnRlbnQgPSBcIlNhdmluZy4uLlwiO1xuICBjb25zdCBuYW1lID0gZWRpdE1vZGFsTmFtZUlucHV0LnZhbHVlO1xuICBjb25zdCBhYm91dCA9IGVkaXRNb2RhbERlc2NyaXB0aW9uSW5wdXQudmFsdWU7XG4gIGFwaVxuICAgIC5lZGl0VXNlckluZm8oeyBuYW1lLCBhYm91dCB9KVxuICAgIC50aGVuKCh1c2VyKSA9PiB7XG4gICAgICBwcm9maWxlTmFtZS50ZXh0Q29udGVudCA9IHVzZXIubmFtZTtcbiAgICAgIHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IHVzZXIuYWJvdXQ7XG4gICAgICBjbG9zZU1vZGFsKGVkaXRNb2RhbCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byB1cGRhdGUgcHJvZmlsZTpcIiwgZXJyKSlcbiAgICAuZmluYWxseSgoKSA9PiAoc3VibWl0QnRuLnRleHRDb250ZW50ID0gb3JpZ2luYWxUZXh0KSk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUFkZENhcmRTdWJtaXQoZXZ0KSB7XG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICBjb25zdCBzdWJtaXRCdG4gPSBldnQuc3VibWl0dGVyO1xuICBjb25zdCBvcmlnaW5hbFRleHQgPSBzdWJtaXRCdG4udGV4dENvbnRlbnQ7XG4gIHN1Ym1pdEJ0bi50ZXh0Q29udGVudCA9IFwiU2F2aW5nLi4uXCI7XG4gIGNvbnN0IG5hbWUgPSBjYXJkQ2FwdGlvbklucHV0LnZhbHVlO1xuICBjb25zdCBsaW5rID0gY2FyZExpbmtJbnB1dC52YWx1ZTtcbiAgYXBpXG4gICAgLmFkZENhcmQoeyBuYW1lLCBsaW5rIH0pXG4gICAgLnRoZW4oKGNhcmQpID0+IHtcbiAgICAgIHJlbmRlckNhcmQoY2FyZCk7XG4gICAgICBjbG9zZU1vZGFsKGNhcmRNb2RhbCk7XG4gICAgICBjYXJkRm9ybS5yZXNldCgpO1xuICAgICAgdG9nZ2xlQnV0dG9uU3RhdGUoW2NhcmRDYXB0aW9uSW5wdXQsIGNhcmRMaW5rSW5wdXRdLCBzdWJtaXRCdG4sIHNldHRpbmdzKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIGFkZCBjYXJkOlwiLCBlcnIpKVxuICAgIC5maW5hbGx5KCgpID0+IChzdWJtaXRCdG4udGV4dENvbnRlbnQgPSBvcmlnaW5hbFRleHQpKTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlQXZhdGFyRm9ybVN1Ym1pdChldnQpIHtcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gIGNvbnN0IHN1Ym1pdEJ0biA9IGV2dC5zdWJtaXR0ZXI7XG4gIGNvbnN0IG9yaWdpbmFsVGV4dCA9IHN1Ym1pdEJ0bi50ZXh0Q29udGVudDtcbiAgc3VibWl0QnRuLnRleHRDb250ZW50ID0gXCJTYXZpbmcuLi5cIjtcbiAgY29uc3QgYXZhdGFyVXJsID0gYXZhdGFyVXJsSW5wdXQudmFsdWU7XG4gIGFwaVxuICAgIC51cGRhdGVBdmF0YXIoYXZhdGFyVXJsKVxuICAgIC50aGVuKCh1c2VyKSA9PiB7XG4gICAgICBwcm9maWxlQXZhdGFyLnNyYyA9IHVzZXIuYXZhdGFyO1xuICAgICAgY2xvc2VNb2RhbChhdmF0YXJNb2RhbCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byB1cGRhdGUgYXZhdGFyOlwiLCBlcnIpKVxuICAgIC5maW5hbGx5KCgpID0+IChzdWJtaXRCdG4udGV4dENvbnRlbnQgPSBvcmlnaW5hbFRleHQpKTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlRGVsZXRlQ2FyZChjYXJkRWxlbWVudCwgZGF0YSkge1xuICBzZWxlY3RlZENhcmQgPSBjYXJkRWxlbWVudDtcbiAgc2VsZWN0ZWRDYXJkSWQgPSBkYXRhLl9pZDtcbiAgb3Blbk1vZGFsKGRlbGV0ZU1vZGFsKTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlRGVsZXRlU3VibWl0KGV2dCkge1xuICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgY29uc3Qgc3VibWl0QnRuID0gZXZ0LnN1Ym1pdHRlcjtcbiAgY29uc3Qgb3JpZ2luYWxUZXh0ID0gc3VibWl0QnRuLnRleHRDb250ZW50O1xuICBzdWJtaXRCdG4udGV4dENvbnRlbnQgPSBcIlNhdmluZy4uLlwiO1xuICBhcGlcbiAgICAucmVtb3ZlQ2FyZChzZWxlY3RlZENhcmRJZClcbiAgICAudGhlbigoKSA9PiB7XG4gICAgICBzZWxlY3RlZENhcmQucmVtb3ZlKCk7XG4gICAgICBjbG9zZU1vZGFsKGRlbGV0ZU1vZGFsKTtcbiAgICAgIHNlbGVjdGVkQ2FyZCA9IG51bGw7XG4gICAgICBzZWxlY3RlZENhcmRJZCA9IG51bGw7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byBkZWxldGUgY2FyZDpcIiwgZXJyKSlcbiAgICAuZmluYWxseSgoKSA9PiAoc3VibWl0QnRuLnRleHRDb250ZW50ID0gb3JpZ2luYWxUZXh0KSk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUxpa2VDbGljayhsaWtlQnRuLCBkYXRhKSB7XG4gIGNvbnN0IGlzTGlrZWQgPSBsaWtlQnRuLmNsYXNzTGlzdC5jb250YWlucyhcImNhcmRfX2xpa2UtYnRuX2xpa2VkXCIpO1xuICBjb25zb2xlLmxvZyhgTGlrZSBidXR0b24gY2xpY2tlZCwgaXNMaWtlZDogJHtpc0xpa2VkfSwgQ2FyZCBJRDogJHtkYXRhLl9pZH1gKTsgLy8gRGVidWdcbiAgY29uc3QgbWV0aG9kID0gaXNMaWtlZCA/IGFwaS5yZW1vdmVMaWtlLmJpbmQoYXBpKSA6IGFwaS5hZGRMaWtlLmJpbmQoYXBpKTtcbiAgbWV0aG9kKGRhdGEuX2lkKVxuICAgIC50aGVuKCh1cGRhdGVkQ2FyZCkgPT4ge1xuICAgICAgY29uc29sZS5sb2coXCJMaWtlIHVwZGF0ZSByZXNwb25zZTpcIiwgdXBkYXRlZENhcmQpOyAvLyBEZWJ1Z1xuICAgICAgY29uc3QgbmV3SXNMaWtlZCA9XG4gICAgICAgIHVwZGF0ZWRDYXJkLmxpa2VzICYmXG4gICAgICAgIHVwZGF0ZWRDYXJkLmxpa2VzLnNvbWUoKGxpa2UpID0+IGxpa2UuX2lkID09PSB1c2VySWQpO1xuICAgICAgbGlrZUJ0bi5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fbGlrZS1idG5fbGlrZWRcIiwgbmV3SXNMaWtlZCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byB1cGRhdGUgbGlrZTpcIiwgZXJyKSk7XG59XG5cbi8vIEV2ZW50IGxpc3RlbmVyc1xucHJvZmlsZUVkaXRCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgZWRpdE1vZGFsTmFtZUlucHV0LnZhbHVlID0gcHJvZmlsZU5hbWUudGV4dENvbnRlbnQ7XG4gIGVkaXRNb2RhbERlc2NyaXB0aW9uSW5wdXQudmFsdWUgPSBwcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQ7XG4gIHJlc2V0VmFsaWRhdGlvbihlZGl0Rm9ybUVsZW1lbnQsIHNldHRpbmdzKTtcbiAgb3Blbk1vZGFsKGVkaXRNb2RhbCk7XG59KTtcblxuY2FyZE1vZGFsQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiBvcGVuTW9kYWwoY2FyZE1vZGFsKSk7XG5hdmF0YXJFZGl0TGluay5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT4ge1xuICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgYXZhdGFyVXJsSW5wdXQudmFsdWUgPSBwcm9maWxlQXZhdGFyLnNyYztcbiAgcmVzZXRWYWxpZGF0aW9uKGF2YXRhckZvcm0sIHNldHRpbmdzKTtcbiAgb3Blbk1vZGFsKGF2YXRhck1vZGFsKTtcbn0pO1xuXG5lZGl0TW9kYWxDbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gY2xvc2VNb2RhbChlZGl0TW9kYWwpKTtcbmNhcmRNb2RhbENsb3NlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiBjbG9zZU1vZGFsKGNhcmRNb2RhbCkpO1xucHJldmlld01vZGFsQ2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IGNsb3NlTW9kYWwocHJldmlld01vZGFsKSk7XG5hdmF0YXJNb2RhbENsb3NlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiBjbG9zZU1vZGFsKGF2YXRhck1vZGFsKSk7XG5kZWxldGVNb2RhbENsb3NlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiBjbG9zZU1vZGFsKGRlbGV0ZU1vZGFsKSk7XG5kZWxldGVNb2RhbENhbmNlbEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gY2xvc2VNb2RhbChkZWxldGVNb2RhbCkpO1xuXG5lZGl0Rm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVFZGl0Rm9ybVN1Ym1pdCk7XG5jYXJkRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZUFkZENhcmRTdWJtaXQpO1xuYXZhdGFyRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZUF2YXRhckZvcm1TdWJtaXQpO1xuZGVsZXRlRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZURlbGV0ZVN1Ym1pdCk7XG5cbmZ1bmN0aW9uIGNsb3NlTW9kYWxCeUVzY2FwZShldnQpIHtcbiAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcbiAgICBjb25zdCBvcGVuZWRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfb3BlbmVkXCIpO1xuICAgIGlmIChvcGVuZWRNb2RhbCkgY2xvc2VNb2RhbChvcGVuZWRNb2RhbCk7XG4gIH1cbn1cblxuZnVuY3Rpb24gY2xvc2VNb2RhbEJ5T3ZlcmxheUNsaWNrKGV2dCkge1xuICBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbFwiKSkge1xuICAgIGNsb3NlTW9kYWwoZXZ0LnRhcmdldCk7XG4gIH1cbn1cblxuLy8gSW5pdGlhbGl6ZVxubG9hZEluaXRpYWxEYXRhKCk7XG5lbmFibGVWYWxpZGF0aW9uKHNldHRpbmdzKTtcbiIsIi8vIHV0aWxzL0FwaS5qc1xuXG5jbGFzcyBBcGkge1xuICBjb25zdHJ1Y3Rvcih7IGJhc2VVcmwsIGhlYWRlcnMgfSkge1xuICAgIHRoaXMuYmFzZVVybCA9IGJhc2VVcmw7XG4gICAgdGhpcy5oZWFkZXJzID0gaGVhZGVycztcbiAgfVxuXG4gIC8vIEhlbHBlciBtZXRob2QgdG8gaGFuZGxlIHJlc3BvbnNlc1xuICBfY2hlY2tSZXNwb25zZShyZXMpIHtcbiAgICBpZiAoIXJlcy5vaykge1xuICAgICAgcmV0dXJuIHJlcy50ZXh0KCkudGhlbigodGV4dCkgPT4ge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEhUVFAgZXJyb3IhIFN0YXR1czogJHtyZXMuc3RhdHVzfSAtICR7dGV4dH1gKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgfVxuXG4gIC8vIEZldGNoIHVzZXIgaW5mbyBhbmQgY2FyZHMgdG9nZXRoZXJcbiAgZ2V0QXBwSW5mbygpIHtcbiAgICByZXR1cm4gUHJvbWlzZS5hbGwoW3RoaXMuZ2V0VXNlckluZm8oKSwgdGhpcy5nZXRJbml0aWFsQ2FyZHMoKV0pLnRoZW4oXG4gICAgICAoW3VzZXIsIGNhcmRzXSkgPT4gKHsgdXNlciwgY2FyZHMgfSlcbiAgICApO1xuICB9XG5cbiAgLy8gRmV0Y2ggdXNlciBpbmZvXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICAvLyBGZXRjaCBpbml0aWFsIGNhcmRzXG4gIGdldEluaXRpYWxDYXJkcygpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgLy8gRWRpdCBwcm9maWxlIHRleHRcbiAgZWRpdFVzZXJJbmZvKHsgbmFtZSwgYWJvdXQgfSkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IG5hbWUsIGFib3V0IH0pLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICAvLyBBZGQgYSBuZXcgY2FyZFxuICBhZGRDYXJkKHsgbmFtZSwgbGluayB9KSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBuYW1lLCBsaW5rIH0pLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICAvLyBEZWxldGUgYSBjYXJkXG4gIHJlbW92ZUNhcmQoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICAvLyBBZGQgYSBsaWtlXG4gIGFkZExpa2UoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICAvLyBSZW1vdmUgYSBsaWtlXG4gIHJlbW92ZUxpa2UoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICAvLyBVcGRhdGUgYXZhdGFyXG4gIHVwZGF0ZUF2YXRhcihhdmF0YXJVcmwpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgYXZhdGFyOiBhdmF0YXJVcmwgfSksXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBBcGk7XG4iXSwibmFtZXMiOlsic2V0dGluZ3MiLCJmb3JtU2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsImhpZGVJbnB1dEVycm9yIiwiZm9ybUVsIiwiaW5wdXRFbCIsImNvbmZpZyIsInF1ZXJ5U2VsZWN0b3IiLCJpZCIsInRleHRDb250ZW50IiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwidG9nZ2xlQnV0dG9uU3RhdGUiLCJpbnB1dExpc3QiLCJidXR0b25FbCIsInNvbWUiLCJpbnB1dCIsInZhbGlkaXR5IiwidmFsaWQiLCJoYXNJbnZhbGlkSW5wdXQiLCJkaXNhYmxlZCIsImFkZCIsInJlc2V0VmFsaWRhdGlvbiIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwiYXBpIiwiY29uc3RydWN0b3IiLCJfcmVmIiwiYmFzZVVybCIsImhlYWRlcnMiLCJ0aGlzIiwiX2NoZWNrUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJ0ZXh0IiwidGhlbiIsIkVycm9yIiwic3RhdHVzIiwiZ2V0QXBwSW5mbyIsIlByb21pc2UiLCJhbGwiLCJnZXRVc2VySW5mbyIsImdldEluaXRpYWxDYXJkcyIsIl9yZWYyIiwidXNlciIsImNhcmRzIiwiZmV0Y2giLCJlZGl0VXNlckluZm8iLCJfcmVmMyIsIm5hbWUiLCJhYm91dCIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiYWRkQ2FyZCIsIl9yZWY0IiwibGluayIsInJlbW92ZUNhcmQiLCJjYXJkSWQiLCJhZGRMaWtlIiwicmVtb3ZlTGlrZSIsInVwZGF0ZUF2YXRhciIsImF2YXRhclVybCIsImF2YXRhciIsImF1dGhvcml6YXRpb24iLCJwcm9maWxlRWRpdEJ0biIsImRvY3VtZW50IiwiY2FyZE1vZGFsQnRuIiwicHJvZmlsZU5hbWUiLCJwcm9maWxlRGVzY3JpcHRpb24iLCJwcm9maWxlQXZhdGFyIiwiZWRpdE1vZGFsIiwiY2FyZE1vZGFsIiwicHJldmlld01vZGFsIiwiYXZhdGFyTW9kYWwiLCJkZWxldGVNb2RhbCIsImVkaXRGb3JtRWxlbWVudCIsImZvcm1zIiwiY2FyZEZvcm0iLCJhdmF0YXJGb3JtIiwiZGVsZXRlRm9ybSIsImVkaXRNb2RhbENsb3NlQnRuIiwiY2FyZE1vZGFsQ2xvc2VCdG4iLCJwcmV2aWV3TW9kYWxDbG9zZUJ0biIsImF2YXRhck1vZGFsQ2xvc2VCdG4iLCJkZWxldGVNb2RhbENsb3NlQnRuIiwiZGVsZXRlTW9kYWxDYW5jZWxCdG4iLCJlZGl0TW9kYWxOYW1lSW5wdXQiLCJlZGl0TW9kYWxEZXNjcmlwdGlvbklucHV0IiwiY2FyZExpbmtJbnB1dCIsImNhcmRDYXB0aW9uSW5wdXQiLCJhdmF0YXJVcmxJbnB1dCIsImF2YXRhckVkaXRMaW5rIiwiY2FyZFRlbXBsYXRlIiwiY2FyZHNMaXN0IiwicHJldmlld01vZGFsSW1hZ2UiLCJwcmV2aWV3TW9kYWxDYXB0aW9uIiwic2VsZWN0ZWRDYXJkIiwic2VsZWN0ZWRDYXJkSWQiLCJ1c2VySWQiLCJnZXRDYXJkRWxlbWVudCIsImRhdGEiLCJjb25zb2xlIiwibG9nIiwiY2FyZEVsZW1lbnQiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiY2FyZE5hbWVFbCIsImNhcmRJbWFnZUVsIiwiY2FyZExpa2VCdG4iLCJjYXJkRGVsZXRlQnRuIiwic3JjIiwiYWx0IiwiaXNMaWtlZCIsIl9pZCIsImFkZEV2ZW50TGlzdGVuZXIiLCJvcGVuTW9kYWwiLCJoYW5kbGVEZWxldGVDYXJkIiwiaGFuZGxlTGlrZUNsaWNrIiwiYmluZCIsInJlbmRlckNhcmQiLCJpdGVtIiwiYXJndW1lbnRzIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwibW9kYWwiLCJjbG9zZU1vZGFsQnlFc2NhcGUiLCJjbG9zZU1vZGFsQnlPdmVybGF5Q2xpY2siLCJjbG9zZU1vZGFsIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImxpa2VCdG4iLCJjb250YWlucyIsInVwZGF0ZWRDYXJkIiwibmV3SXNMaWtlZCIsImxpa2VzIiwibGlrZSIsInRvZ2dsZSIsImNhdGNoIiwiZXJyIiwiZXJyb3IiLCJldnQiLCJrZXkiLCJvcGVuZWRNb2RhbCIsInRhcmdldCIsInZhbHVlIiwicHJldmVudERlZmF1bHQiLCJzdWJtaXRCdG4iLCJzdWJtaXR0ZXIiLCJvcmlnaW5hbFRleHQiLCJmaW5hbGx5IiwiY2FyZCIsInJlc2V0IiwiaW5uZXJIVE1MIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJidXR0b25FbGVtZW50IiwiaW5wdXRFbGVtZW50IiwiY2hlY2tJbnB1dFZhbGlkaXR5Iiwic2hvd0lucHV0RXJyb3IiLCJlcnJvck1zZyIsInZhbGlkYXRpb25NZXNzYWdlIl0sInNvdXJjZVJvb3QiOiIifQ==